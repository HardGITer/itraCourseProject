<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    {% load staticfiles %}
    {% load static i18n %}
    <br><br>
    {% get_current_language as LANGUAGE_CODE %}
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/tinyinit.js' %}"></script>

    <script>
        tinymce.init({
  selector: '#editor',
  plugins: 'image code paste',
  toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignrigth alignjustify | bullist numlist outdent indent | link image media",
  // enable title field in the Image dialog
  image_title: true,
  image_upload_url: true,
  // enable automatic uploads of images represented by blob or data URIs
  automatic_uploads: true,
  // add custom filepicker only to Image dialog
  file_picker_types: 'image',
  paste_data_images:true,
  file_picker_callback: function(cb, value, meta) {
    var input = document.createElement('input');
    input.setAttribute('type', 'file');
    input.setAttribute('accept', 'image/*');

    input.onchange = function() {
      var file = this.files[0];
      var reader = new FileReader();

      reader.onload = function () {
        var id = 'blobid' + (new Date()).getTime();
        var blobCache =  tinymce.activeEditor.editorUpload.blobCache;
        var base64 = reader.result.split(',')[1];
        //alert(base64);
        var blobInfo = blobCache.create(id, file, base64);
        //alert(blobInfo.blobUri());
        //blobInfo.blobUri() = "https://st.depositphotos.com/1752627/2306/i/450/depositphotos_23061294-stock-photo-hearts-drawn-on-the-sand.jpg";
        blobCache.add(blobInfo);
        // call the callback and populate the Title field with the file name
        cb(blobInfo.blobUri(), { title: file.name });
        //cb("https://st.depositphotos.com/1752627/2306/i/450/depositphotos_23061294-stock-photo-hearts-drawn-on-the-sand.jpg", { title: file.name });
        //alert(blobInfo.blobUri() + "  filename  " + file.name);
      };
      reader.readAsDataURL(file);
    };

    input.click();
  }
});

    </script>

</head>

<header style="margin-bottom:70px">
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/main/">{% trans "Название сайта"%}</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
                    aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                    <!--<li class="nav-item active">-->
                    <!--<a class="nav-link" href="#">{% trans "Домой"%}<span class="sr-only">(current)</span></a>-->
                    <!--</li>-->
                    <!--<li class="nav-item">-->
                    <!--<a class="nav-link" href="#">{% trans "Создать конспект"%}<span class="sr-only">(current)</span></a>-->
                    <!--</li>-->
                    <!--<li class="nav-item">-->
                    <!--<a class="nav-link" href="#">Link</a>-->
                    <!--</li>-->
                    <!--<li class="nav-item">-->
                    <!--<a class="nav-link disabled" href="#">Disabled</a>-->
                    <!--</li>-->
                </ul>
                <form style="float:right;" class="form-inline mt-2 mt-md-0">
                    <input style="width:300px;" class="form-control mr-sm-2" type="text"
                           placeholder='{% trans "Поиск"%}' aria-label="Search">
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">{% trans "Поиск"%}</button>
                </form>
                <ul style="float:right;" class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/main/cabinet/{{ user.id }}/create">&#9998;<span
                                class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">&#9993;<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/main/cabinet/{{ user.id }}">{{ user.username }}</a>
                    </li>
                </ul>
            </div>
            <form action="{% url 'set_language' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ redirect_to }}">
                <select name="language" id="">
                    {% get_available_languages as LANGUAGES %}
                    {% get_language_info_list for LANGUAGES as languages %}
                    {% for language in languages %}
                    <option value="{{ language.code }}" {% if language.code == LANGUAGE_CODE %} selected {% endif %}>
                        <!--{{ language.name_local }}--> {{ language.code }}
                    </option>
                    {% endfor %}
                </select>
                <input type="submit" value="Go">
            </form>
        </div>
        </div>
    </nav>


</header>

<body>
<!--<div class="container" style="border: 1px solid; display:block;">-->

<!--</div>-->

{% block content%}

{% endblock %}


</body>

<!--<script src="//widget.cloudinary.com/global/all.js" type="text/javascript"></script>-->
<!--<script type="text/javascript">-->
<!--var res;-->
<!--document.getElementById("upload_widget_opener").addEventListener("click", function() {-->
<!--cloudinary.openUploadWidget({ cloud_name: 'debkidgiu', upload_preset: 'ep22wd9t'},-->
<!--function(error, result) { console.log(error, result);-->
<!--res = result;-->
<!--console.log('type ar: ', res[0].secure_url);});-->
<!--}, false);-->
<!--</script>-->

</html>